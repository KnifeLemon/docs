# JSON Wrapper

## Огляд

Клас `Json` у Flight надає простий, послідовний спосіб кодування та декодування JSON-даних у вашому додатку. Він обгортає вбудовані функції JSON PHP з кращою обробкою помилок і деякими корисними налаштуваннями за замовчуванням, роблячи роботу з JSON простішою та безпечнішою.

## Розуміння

Робота з JSON є надзвичайно поширеною в сучасних PHP-додатках, особливо під час створення API або обробки AJAX-запитів. Клас `Json` централізує все кодування та декодування JSON, тому вам не потрібно турбуватися про дивні крайні випадки або загадкові помилки від вбудованих функцій PHP.

Ключові особливості:
- Послідовна обробка помилок (викидає винятки у разі невдачі)
- Налаштування за замовчуванням для кодування/декодування (наприклад, неекрановані слеші)
- Утилітарні методи для красивого виведення та перевірки

## Основне використання

### Кодування даних у JSON

Щоб перетворити PHP-даний у рядок JSON, використовуйте `Json::encode()`:

```php
use flight\util\Json;

$data = [
  'framework' => 'Flight',
  'version' => 3,
  'features' => ['routing', 'views', 'extending']
];

$json = Json::encode($data);
echo $json;
// Output: {"framework":"Flight","version":3,"features":["routing","views","extending"]}
```

Якщо кодування не вдається, ви отримаєте виняток з корисним повідомленням про помилку.

### Красиве виведення

Хочете, щоб ваш JSON був читабельним для людини? Використовуйте `prettyPrint()`:

```php
echo Json::prettyPrint($data);
/*
{
  "framework": "Flight",
  "version": 3,
  "features": [
    "routing",
    "views",
    "extending"
  ]
}
*/
```

### Декодування рядків JSON

Щоб перетворити рядок JSON назад у PHP-даний, використовуйте `Json::decode()`:

```php
$json = '{"framework":"Flight","version":3}';
$data = Json::decode($json);
echo $data->framework; // Output: Flight
```

Якщо ви хочете асоціативний масив замість об'єкта, передайте `true` як другий аргумент:

```php
$data = Json::decode($json, true);
echo $data['framework']; // Output: Flight
```

Якщо декодування не вдається, ви отримаєте виняток з чітким повідомленням про помилку.

### Перевірка JSON

Перевірте, чи є рядок валідним JSON:

```php
if (Json::isValid($json)) {
  // Він валідний!
} else {
  // Не валідний JSON
}
```

### Отримання останньої помилки

Якщо ви хочете перевірити останнє повідомлення про помилку JSON (з вбудованих функцій PHP):

```php
$error = Json::getLastError();
if ($error !== '') {
  echo "Last JSON error: $error";
}
```

## Розширене використання

Ви можете налаштувати параметри кодування та декодування, якщо вам потрібно більше контролю (див. [опції json_encode PHP](https://www.php.net/manual/en/json.constants.php)):

```php
// Кодування з опцією HEX_TAG
$json = Json::encode($data, JSON_HEX_TAG);

// Декодування з користувацькою глибиною
$data = Json::decode($json, false, 1024);
```

## Дивіться також

- [Collections](/learn/collections) - Для роботи зі структурованими даними, які можна легко перетворити на JSON.
- [Configuration](/learn/configuration) - Як налаштувати ваш додаток Flight.
- [Extending](/learn/extending) - Як додати власні утиліти або перевизначити основні класи.

## Вирішення проблем

- Якщо кодування або декодування не вдається, викидається виняток — обгорніть ваші виклики в try/catch, якщо хочете обробляти помилки граціозно.
- Якщо ви отримуєте несподівані результати, перевірте ваші дані на циклічні посилання або не-UTF8 символи.
- Використовуйте `Json::isValid()`, щоб перевірити, чи є рядок валідним JSON перед декодуванням.

## Журнал змін

- v3.16.0 - Додано утиліту класу обгортки JSON.