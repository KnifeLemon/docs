# Колекції

## Огляд

Клас `Collection` у Flight є зручною утилітою для керування наборами даних. Він дозволяє доступатися та маніпулювати даними за допомогою як синтаксису масивів, так і об'єктів, роблячи ваш код чистішим і гнучкішим.

## Розуміння

`Collection` по суті є обгорткою навколо масиву, але з деякими додатковими можливостями. Ви можете використовувати його як масив, перебирати його, рахувати елементи та навіть доступатися до елементів так, ніби це властивості об'єкта. Це особливо корисно, коли ви хочете передавати структуровані дані у вашому додатку або робити код більш читабельним.

Колекції реалізують кілька інтерфейсів PHP:
- `ArrayAccess` (щоб ви могли використовувати синтаксис масивів)
- `Iterator` (щоб ви могли перебирати за допомогою `foreach`)
- `Countable` (щоб ви могли використовувати `count()`)
- `JsonSerializable` (щоб ви могли легко конвертувати в JSON)

## Основне використання

### Створення колекції

Ви можете створити колекцію, просто передавши масив до її конструктора:

```php
use flight\util\Collection;

$data = [
  'name' => 'Flight',
  'version' => 3,
  'features' => ['routing', 'views', 'extending']
];

$collection = new Collection($data);
```

### Доступ до елементів

Ви можете доступатися до елементів за допомогою синтаксису масивів або об'єктів:

```php
// Синтаксис масиву
echo $collection['name']; // Вивід: FlightPHP

// Синтаксис об'єкта
echo $collection->version; // Вивід: 3
```

Якщо ви спробуєте доступитися до ключа, якого не існує, ви отримаєте `null` замість помилки.

### Встановлення елементів

Ви також можете встановлювати елементи за допомогою будь-якого з цих синтаксисів:

```php
// Синтаксис масиву
$collection['author'] = 'Mike Cao';

// Синтаксис об'єкта
$collection->license = 'MIT';
```

### Перевірка та видалення елементів

Перевірте, чи існує елемент:

```php
if (isset($collection['name'])) {
  // Зробіть щось
}

if (isset($collection->version)) {
  // Зробіть щось
}
```

Видаліть елемент:

```php
unset($collection['author']);
unset($collection->license);
```

### Перебір колекції

Колекції є ітерованими, тому ви можете використовувати їх у циклі `foreach`:

```php
foreach ($collection as $key => $value) {
  echo "$key: $value\n";
}
```

### Підрахунок елементів

Ви можете порахувати кількість елементів у колекції:

```php
echo count($collection); // Вивід: 4
```

### Отримання всіх ключів або даних

Отримайте всі ключі:

```php
$keys = $collection->keys(); // ['name', 'version', 'features', 'license']
```

Отримайте всі дані як масив:

```php
$data = $collection->getData();
```

### Очищення колекції

Видаліть всі елементи:

```php
$collection->clear();
```

### Серійалізація JSON

Колекції можна легко конвертувати в JSON:

```php
echo json_encode($collection);
// Вивід: {"name":"FlightPHP","version":3,"features":["routing","views","extending"],"license":"MIT"}
```

## Розширене використання

Ви можете повністю замінити внутрішній масив даних, якщо потрібно:

```php
$collection->setData(['foo' => 'bar']);
```

Колекції особливо корисні, коли ви хочете передавати структуровані дані між компонентами або надавати більш об'єктно-орієнтований інтерфейс для даних масиву.

## Дивіться також

- [Requests](/learn/requests) - Дізнайтеся, як обробляти HTTP-запити та як колекції можна використовувати для керування даними запитів.
- [PDO Wrapper](/learn/pdo-wrapper) - Дізнайтеся, як використовувати обгортку PDO у Flight та як колекції можна використовувати для керування результатами бази даних.

## Вирішення проблем

- Якщо ви спробуєте доступитися до ключа, якого не існує, ви отримаєте `null` замість помилки.
- Пам'ятайте, що колекції не є рекурсивними: вкладені масиви не автоматично конвертуються в колекції.
- Якщо вам потрібно скинути колекцію, використовуйте `$collection->clear()` або `$collection->setData([])`.

## Журнал змін

- v3.0 - Покращені підказки типів та підтримка PHP 8+.
- v1.0 - Початковий реліз класу Collection.